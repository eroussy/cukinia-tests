cukinia_log "$(_colorize yellow "--- check apt configuration ---")"

OFFICIAL_REPOS="(\
artifacts.elastic.co|\
download.docker.com|\
ftp.fr.debian.org|\
security.debian.org\
)"
# Awk exptression extract the repositorie's hostname
# deb http://ftp.fr.debian.org/debian bullseye main contrib non-free --> ftp.fr.debian.org
as "SEAPATH-00181 - Only official apt repositories configured" \
    cukinia_test "$(awk -F / -- '/^[^#]/{print $3;}' /etc/apt/sources.list /etc/apt/sources.list.d/* | grep -Ev ${OFFICIAL_REPOS})" = ""

MINIMAL_PACKAGES="(\
adduser|\
apt|\
apt-transport-https|\
apt-utils|\
at|\
base-files|\
zlib1g\
)"
as "SEAPATH-00182 - Only minimal packages installed" \
    cukinia_test "$(apt-mark showmanual | grep -Ev ${MINIMAL_PACKAGES})" = ""
